<html>
  <head>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100dvh;
        width: 100dvh;
        overflow: hidden;
        background-color: red;
      }

      .content {
        inset: 0;
        position: absolute;
        overflow: hidden;
      }

      .content img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        position: absolute;
        inset: 0;
      }

      .crosshairs {
        background-color: gold;
        position: absolute;
        transition: transform linear;
        transition-duration: 1s;
      }

      .crosshairs.horizontal {
        width: 100dvw;
        height: 1px;
        top: -1px;
      }

      .crosshairs.vertical {
        width: 1px;
        height: 100dvh;
        left: -1px;
      }

      .marker {
        position: absolute;
        background-color: red;
      }

      .marker.x {
        width: 7px;
        height: 1px;
        margin-left: -3px;
      }

      .marker.y {
        width: 1px;
        height: 7px;
        margin-top: -3px;
      }

    </style>
    <script type="module">
      import { moveToCoordinates } from './crosshair.js';
      import { fetchEarthquakeData } from './data.js';
      import { markCoordinate } from './gui.js';
      import { getMapDimensions, latLngToPixel } from './map.js';

      const dataPromise = fetchEarthquakeData();

      document.addEventListener("DOMContentLoaded", async () => {
        const data = await dataPromise;
        const { mapWidth, mapHeight, mapXOverflow, mapYOverflow } =
          getMapDimensions();

        let i = 0;
        while (true) {
          const earthquake = data.features[i % data.features.length];
          const { x, y } = latLngToPixel({
            mapWidth,
            mapHeight,
            mapXOverflow,
            mapYOverflow,
            lat: earthquake.geometry.coordinates[1],
            lng: earthquake.geometry.coordinates[0],
          });
          await moveToCoordinates(x, y);
          markCoordinate(x, y);
          i++;
        }
      });
    </script>
  </head>

  <body>
    <div class="content">
      <img src="./map_bw.jpg" alt="World map" width="2058" height="2058">
      <div class="crosshairs horizontal"></div>
      <div class="crosshairs vertical"></div>
    </div>
  </body>
</html>
